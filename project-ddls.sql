CREATE SCHEMA "DEMO"."STG";
CREATE SCHEMA "DEMO"."LND";
CREATE SCHEMA "DEMO"."ODS";
use database DEMO;
------------------------- create STG Tables --------------------------
use schema STG;

create or replace TABLE META_DATA (
	FILE_NM VARCHAR(16777216),
	DELIM VARCHAR(16777216),
	SF_TAB_NM VARCHAR(16777216),
	gen_lkp_file VARCHAR(1),
	need_trans VARCHAR(1),
	is_active VARCHAR(1)
	
);
insert into DEMO.STG.META_DATA values ('orders.csv', '\\t','SF_ORDERS','N','Y','Y');
insert into DEMO.STG.META_DATA values ('people.csv', ',','SF_PEOPLE','Y','Y','Y');
insert into DEMO.STG.META_DATA values ('returns.csv', '`~^','SF_RETURNS','N','Y','Y');

create or replace TABLE SF_ORDERS (
	ROW_ID VARCHAR(16777216),
	ORDER_ID VARCHAR(16777216),
	ORDER_DATE VARCHAR(16777216),
	SHIP_DATE VARCHAR(16777216),
	SHIP_MODE VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	CUSTOMER_NAME VARCHAR(16777216),
	SEGMENT VARCHAR(16777216),
	COUNTRY VARCHAR(16777216),
	CITY VARCHAR(16777216),
	STATE VARCHAR(16777216),
	POSTAL_CODE VARCHAR(16777216),
	REGION VARCHAR(16777216),
	PRODUCT_ID VARCHAR(16777216),
	CATEGORY VARCHAR(16777216),
	SUB_CATEGORY VARCHAR(16777216),
	PRODUCT_NAME VARCHAR(16777216),
	SALES VARCHAR(16777216),
	QUANTITY VARCHAR(16777216),
	DISCOUNT VARCHAR(16777216),
	PROFIT VARCHAR(16777216)
);

create or replace TABLE SF_PEOPLE (
	ID NUMBER(38,0),
	PERSON VARCHAR(16777216),
	REGION VARCHAR(16777216)
);

create or replace TABLE SF_RETURNS (
	ORDER_RETURNED VARCHAR(3),
	ORDER_ID VARCHAR(16777216)
);

-------------------------- create STG Tables --------------------------
use schema LND;
create or replace TABLE SF_ORDERS (
	ROW_ID VARCHAR(16777216),
	ORDER_ID VARCHAR(16777216),
	ORDER_DATE VARCHAR(16777216),
	SHIP_DATE VARCHAR(16777216),
	SHIP_MODE VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	CUSTOMER_NAME VARCHAR(16777216),
	SEGMENT VARCHAR(16777216),
	COUNTRY VARCHAR(16777216),
	CITY VARCHAR(16777216),
	STATE VARCHAR(16777216),
	POSTAL_CODE VARCHAR(16777216),
	REGION VARCHAR(16777216),
	PRODUCT_ID VARCHAR(16777216),
	CATEGORY VARCHAR(16777216),
	SUB_CATEGORY VARCHAR(16777216),
	PRODUCT_NAME VARCHAR(16777216),
	SALES VARCHAR(16777216),
	QUANTITY VARCHAR(16777216),
	DISCOUNT VARCHAR(16777216),
	PROFIT VARCHAR(16777216)
);

create or replace TABLE SF_PEOPLE (
	ID NUMBER(38,0),
	PERSON VARCHAR(16777216),
	REGION VARCHAR(16777216)
);

create or replace TABLE SF_RETURNS (
	ORDER_RETURNED VARCHAR(3),
	ORDER_ID VARCHAR(16777216)
);

-------------------------- create STG Tables --------------------------
use schema ODS;
create or replace TABLE SF_ORDERS (
	ROW_ID VARCHAR(16777216),
	ORDER_ID VARCHAR(16777216),
	ORDER_DATE VARCHAR(16777216),
	SHIP_DATE VARCHAR(16777216),
	SHIP_MODE VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	CUSTOMER_NAME VARCHAR(16777216),
	SEGMENT VARCHAR(16777216),
	COUNTRY VARCHAR(16777216),
	CITY VARCHAR(16777216),
	STATE VARCHAR(16777216),
	POSTAL_CODE VARCHAR(16777216),
	REGION VARCHAR(16777216),
	PRODUCT_ID VARCHAR(16777216),
	CATEGORY VARCHAR(16777216),
	SUB_CATEGORY VARCHAR(16777216),
	PRODUCT_NAME VARCHAR(16777216),
	SALES VARCHAR(16777216),
	QUANTITY VARCHAR(16777216),
	DISCOUNT VARCHAR(16777216),
	PROFIT VARCHAR(16777216)
);

create or replace TABLE SF_PEOPLE (
	ID NUMBER(38,0),
	PERSON VARCHAR(16777216),
	REGION VARCHAR(16777216)
);

create or replace TABLE SF_RETURNS (
	ORDER_RETURNED VARCHAR(3),
	ORDER_ID VARCHAR(16777216)
);
create or replace TABLE DIM_PEOPLE (
	ID NUMBER(38,0),
	PERSON VARCHAR(16777216),
	REGION VARCHAR(16777216),
	INS_DT TIMESTAMP_NTZ(9),
	UPD_DT TIMESTAMP_NTZ(9),
	MTL_RUN_ID INTEGER
);

